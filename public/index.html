<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Bookmarklet Quine Editor</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel="icon" type="image/png" href="data:image/png;base64,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">
	<meta author="https://github.com/hagb4rd">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="fp:profile_id"				content="" />
	<meta property="og:url"                content="https://ctrld.herokuapp.com/" />
	<meta property="og:type"               content="profile" />
	<meta property="og:title"              content="Bookmarklet Quine Editor" />
	<meta property="og:description"        content="Drag the created Link into the your bookmark bar to inject this editor in your website." />
	<meta property="og:image"              content="thumb.png" />
	<script src="https://unpkg.com/ea-webkit@latest/dist/webkit.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.3.3/ace.js"></script>
	<script src="Event.js"></script>
	<script src="ColorSphereBackground.js"></script>

	<style>
		body {
			margin: 0px;
			padding: 0px;
			background: url('snowfall.gif') no-repeat center center fixed;
			-webkit-background-size: cover; /* For WebKit*/
			-moz-background-size: cover;    /* Mozilla*/
			-o-background-size: cover;      /* Opera*/
			background-size: cover;         /* Generic*/
			font-family: Robo;
			background-color: rgb(40, 90, 108);
		}

		.blende {
			position: relative;
			overflow: hidden;
			height: 800px;
			margin: 1.5em 0 0 0;
		}

		.blende img {
			height: 800px;
		}

		.blende img.zoom {
			-webkit-transform: scale(2.6) rotate(0.1deg);
			-moz-transform: scale(2.6) rotate(0.1deg);
			transform: scale(2.6) rotate(0.1deg);
		}

		#footer {
			border-top: 1px solid rgba(0, 0, 0, 0.25);
			overflow: hidden;
			padding: 0 auto;
			margin: 0 auto;
			width: 100%;
			position: absolute;
			z-index: 0;
			height: 100%;
		}

		#footer:after {
			content: " ";
			background: url('interlace-diagonal-light.png');
			width: 100%;
			height: inherit;
			position: absolute;
			top: 0;
			left: 0;
			z-index: 0;
		}

		#_btnBookmarklet:hover {
			background-color: black;
			border: 3px red solid;
			color: red;
		}
		

		.firelayer {
			position:fixed;
			opacity: 0.0;
			height: 100vh;
			top: 0;
			left: 0;
			z-index: 9;
			display: block;
			transition: opacity 300ms;	
		}
		.firelayer.active {
			opacity: 1.0;
		}
		.firelayer.inactive {
			opacity: 0.0
		}
		
		
		.hidden {
			z-index: -100;
		}
	</style>
</head>
<body>
<div id="footer"></div>
<script language="JavaScript">
	
	document.addEventListener('DOMContentLoaded',() => {
	
		$.toolbox()
			.then(({editor, btnToolbox,btnBookmarklet}) => {
	
				//default gist to load 
				var defaultGistUrl = 'https://gist.github.com/hagb4rd/6843803a6674fe1b9ead6f1e60f14f15#file-toolbox-js'; 
	
				//parse GET query params url and file into github gist link format into location.hash 
				var _uri=new URL(location.href);
				var url=_uri.searchParams.get('url')||encodeURIComponent(defaultGistUrl);
				var file=_uri.searchParams.get('file')||'';
				if(url)
					url=decodeURIComponent(url);
				if(file) {
					file=decodeURIComponent(file);
					file=`#file-${file.replace(/\./g,'-')}`;
					url=url+file;
				}
				var hashChange = () => {
					$.gist.file(decodeURIComponent(location.hash.slice(1))).then(file=>{ editor.session.setValue(file.content) })
				}
				window.onhashchange=hashChange;
				if(location.hash) {
						hashChange();
				} else {
					location.hash = encodeURIComponent(url);
					hashChange();
				}
	
				/* --------- FX-------------- */
	
				//firelayer
				var firelayer=$.create('video', { 
					id: "_firelayer",
					src:"/flames2.mp4", 
					preload:"auto", 
					loop:"loop", 
					type:"video/mp4",
					class:"firelayer hidden"
				});
				document.body.append(firelayer);
				firelayer.active=function() {
					window.requestAnimationFrame(()=>{
						firelayer.classList.remove('inactive');
						firelayer.classList.add('active');	
					})
				}
				firelayer.inactive=function() {
					window.requestAnimationFrame(()=>{
						firelayer.classList.remove('active');
						firelayer.classList.add('inactive');	
					})
				}
	
	
				firelayer.addEventListener('canplay',firelayer.play.bind(firelayer));
				firelayer.addEventListener('ended',firelayer.play.bind(firelayer));
				firelayer.resize=function(e) {
						firelayer.style.width=window.innerWidth;
						firelayer.style.height=window.innerHeight;
				};
				firelayer.resize();
				firelayer.toggle=function(e) {
					/*
					if(firelayer.style.display=='none') {
						firelayer.style.display='block';
					} else {
						firelayer.style.display='none';
					}
					/* */
					firelayer.classList.toggle('hidden');
				}
	
				firelayer.mouseover=function(e){ 
	
						/*
						document.body.append(firelayer);
						firelayer.animate([{opacity: 0}, {opacity:1}], {
								duration: 300,
								iterations: 1,
								delay: 0,
								fill: "forwards"
							});
						*/ 
						firelayer.active();
						console.log('firelayer: ', [...firelayer.classList.entries()].join(', '));
				}
				firelayer.mouseout=function(e){ 
						/*
						document.body.append(firelayer);
						var animation=firelayer.animate([{opacity: 0}, {opacity:1}], {
								duration: 300,
								iterations: 1,
								delay: 0,
								fill: "backwards"
							});
						animation.finished.then(()=>{
								firelayer.parent.remove(firelayer);
						}).catch(()=>{
								firelayer.parent.remove(firelayer);
						});
						*/
						firelayer.inactive();
						console.log('firelayer: ', [...firelayer.classList.entries()].join(', '));
				}
				window.addEventListener('resize', (e)=>firelayer.resize());
				btnBookmarklet.addEventListener('mouseover', (e)=>firelayer.mouseover(e));
				btnBookmarklet.addEventListener('mouseout', (e)=>firelayer.mouseout(e));
				btnToolbox.addEventListener("click", (e)=>{
					firelayer.toggle();
					firelayer.play();
				});		
		});
	});
		
	</script>
</body>
</html>